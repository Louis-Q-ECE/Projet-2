// fonction pour faire un menu cliquable
#include "overck.h"
#include <stdbool.h> // Inclure stdbool.h pour utiliser true et false

// Fonction pour afficher les commandes
void afficher_commandes() {
    clear_to_color(screen, makecol(255, 255, 255));

    textout_centre_ex(screen, font, "Commandes du jeu:", SCREEN_WIDTH / 2, 30, makecol(0, 0, 0), -1);

    // Commandes du joueur 1
    textout_centre_ex(screen, font, "Joueur 1:", SCREEN_WIDTH / 2, 60, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "Z - Avancer", SCREEN_WIDTH / 2, 90, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "S - Reculer", SCREEN_WIDTH / 2, 120, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "Q - Gauche", SCREEN_WIDTH / 2, 150, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "D - Droite", SCREEN_WIDTH / 2, 180, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "T - Lacher", SCREEN_WIDTH / 2, 210, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "E - Attraper", SCREEN_WIDTH / 2, 240, makecol(0, 0, 0), -1);

    // Commandes du joueur 2
    textout_centre_ex(screen, font, "Joueur 2:", SCREEN_WIDTH / 2, 270, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "fleche haute - Avancer", SCREEN_WIDTH / 2, 300, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "fleche bas - Reculer", SCREEN_WIDTH / 2, 330, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "fleche gauche - Gauche", SCREEN_WIDTH / 2, 360, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "fleche droite - Droite", SCREEN_WIDTH / 2, 390, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "J - Attraper", SCREEN_WIDTH / 2, 420, makecol(0, 0, 0), -1);
    textout_centre_ex(screen, font, "L - Lacher", SCREEN_WIDTH / 2, 450, makecol(0, 0, 0), -1);

    textout_centre_ex(screen, font, "ECHAP - Retour au menu", SCREEN_WIDTH / 2, 480, makecol(0, 0, 0), -1);

    while (true) {
        if (key[KEY_ESC]) {
            break;
        }
        rest(1);
    }
}

void afficher_menu() {
    show_mouse(screen);
    clear_to_color(screen, makecol(255, 255, 255));

    BITMAP* image1 = load_bitmap("image1.bmp", NULL);
    if (!image1) {
        allegro_message("impossible de charger l'image image1.bmp!");
        return;
    }
    blit(image1, screen, 0, 0, 0, 0, SCREEN_WIDTH, SCREEN_HEIGHT);
    destroy_bitmap(image1);

    // faire un rectangle pour les règles
    int regles_x = SCREEN_WIDTH / 2 - 130;
    int regles_y = 100;
    rect(screen, regles_x, regles_y, regles_x + 260, regles_y + 50, makecol(0, 0, 0));
    textout_centre_ex(screen, font, "Appuyez sur 'r' pour les règles.", regles_x + 130, regles_y + 25, makecol(0, 0, 0), -1);

    // faire un bouton cliquable "jouer"
    int jouer_x = SCREEN_WIDTH / 2 - 50;
    int jouer_y = SCREEN_HEIGHT / 2;
    int jouer_w = 100;
    int jouer_h = 50;
    int jouer_color = makecol(0, 0, 255);

    // faire un bouton cliquable "les commandes"
    int commandes_x = SCREEN_WIDTH / 2 - 75;
    int commandes_y = jouer_y + 80; // placé en dessous du bouton "jouer"
    int commandes_w = 150;
    int commandes_h = 50;
    int commandes_color = makecol(0, 0, 255);

    while (!mouse_b & 1) {
        rest(1);

        // dessiner le bouton "jouer"
        rect(screen, jouer_x, jouer_y, jouer_x + jouer_w, jouer_y + jouer_h, jouer_color);
        textout_centre_ex(screen, font, "JOUER", jouer_x + jouer_w / 2, jouer_y + jouer_h / 2, makecol(255, 255, 255), -1);

        // tester si "jouer" est cliqué
        if (mouse_x >= jouer_x && mouse_x <= jouer_x + jouer_w && mouse_y >= jouer_y && mouse_y <= jouer_y + jouer_h) {
            jouer_color = makecol(255, 0, 0);
            if (mouse_b & 1) {
                // code pour démarrer le jeu ici
                break;
            }
        } else {
            jouer_color = makecol(0, 0, 255);
        }

        // dessiner le bouton "les commandes"
        rect(screen, commandes_x, commandes_y, commandes_x + commandes_w, commandes_y + commandes_h, commandes_color);
        textout_centre_ex(screen, font, "LES COMMANDES", commandes_x + commandes_w / 2, commandes_y + commandes_h / 2, makecol(255, 255, 255), -1);

        // tester si "les commandes" est cliqué
        if (mouse_x >= commandes_x && mouse_x <= commandes_x + commandes_w && mouse_y >= commandes_y && mouse_y <= commandes_y + commandes_h) {
            commandes_color = makecol(255, 0, 0);
            if (mouse_b & 1) {
                afficher_commandes();
                clear_to_color(screen, makecol(255, 255, 255));
                blit(image1, screen, 0, 0, 0, 0, SCREEN_WIDTH, SCREEN_HEIGHT); // Recharger l'image de fond après retour du menu des commandes
            }
        } else {
            commandes_color = makecol(0, 0, 255);
        }
    }

    show_mouse(NULL);
}
